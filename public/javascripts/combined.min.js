// Jacob Friesen http://jacobfriesen.com/ MIT Licenced
if(typeof Object.nu!=="function"){Object.nu=function(b){function a(){}a.prototype=b;return new a()}}else{throw ("Object.new is already defined")}utility={SHOW:"-",HIDE:"+",attach_show_events:function(b){var a={init:function(c){this.triggers=b.triggers;this.event=b.event;this.collapsers=b.collapsers;this.on_hide=b.on_hide;this.on_show=b.on_show;this.chk_attr="name";if(b.chk_attr){this.chk_attr=b.chk_attr}if(!c){this.attach_events()}return this},attach_events:function(){this.order_matchers_by_name();for(var d=0,e=0;d<this.triggers.length&&e<this.triggers.length;e++){if($(this.triggers[d]).attr(this.chk_attr)==$(this.collapsers[e]).attr(this.chk_attr)){this.triggers[d].collapser=this.collapsers[e];$(this.triggers[d])[this.event]($.proxy(this.on_event,this));d+=1}}},on_event:function(d){var c=d.currentTarget;if($(c.collapser).css("display")=="none"){this.on_show(c,c.collapser)}else{this.on_hide(c,c.collapser)}},open:function(c){this.do_event("on_show",c);return this},close:function(c){this.do_event("on_hide",c);return this},do_event:function(e,c){if(c=="all"){for(var d=0;d<this.triggers.length;d++){this[e](this.triggers[d],this.triggers[d].collapser)}}else{this[e](this.triggers[c],this.triggers[c].collapser)}},order_matchers_by_name:function(){if(!this.triggers||!this.triggers.sort){return false}if(!this.collapsers||!this.collapsers.sort){return false}if(this.triggers.length!=this.collapsers.length){throw ("triggers must be the same length as collapsers")}var c=this;var d=function(f,e){if($(f).attr(c.chk_attr)>$(e).attr(c.chk_attr)){return 1}if($(f).attr(c.chk_attr)<$(e).attr(c.chk_attr)){return -1}return 0};this.triggers.sort(d);this.collapsers.sort(d);return true},get_collapsee:function(c){var d=c.id.split("_").pop();return $("#"+this.collapse_to+d)}};return Object.nu(a.init(b.delay))}};var head=document.getElementsByTagName("head");Class.create(function Changable(){var b=null;var a=null;return{isDisplayed:null,currOrder:0,addElement:function(c){this.element=$("#"+c)[0];this.idName=c}}},this);Class.create(function ChangableList(b){if(b){var a=[];for(var c=0;c<b.length;c++){a[c]=new Changable();a[c].addElement(b[c]);a[c].isDisplayed=false}}return{changables:a,getItem:function(d){return this.changables[d]},getElement:function(d){return this.changables[d].element},getChangableFromId:function(e){for(var d=0;d<this.changables.length;d++){if(this.changables[d].element.id==e){return this.changables[d]}}return null}}},this);ChangableList.create(function MovableList(a){return{dispNum:0,confDisp:true,isSnappable:true,MOVE_BY:62,AS_CLOSE:35,SNAP_DIST:35,SNAP_CLOSE:10,displayObject:function(d){var b=this.getChangableFromId(d);if(this.dispNum==-1){this.confDisp=false}else{this.confDisp=true}if(b!=null&&b.isDisplayed==false){this.dispNum++;if(this.confDisp==true){b.element.style.display="inline";var c=$("#"+d+"Btn")[0];if(c!=null){c.className="clickedButton";decideColor(c)}putInFront(b.element);if(this.dispNum>0){this.shiftOthBoxes(b,b.element.style.top,b.element.style.left)}}b.isDisplayed=true}else{b.element.style.display="none";b.isDisplayed=false;var c=$("#"+d+"Btn")[0];if(c!=null){c.className="leftMenuButton";c.style.backgroundColor=""}this.dispNum--}},moveToMenu:function(b){b.element.style.left=(toNum(this.changables[0].element.style.left)+this.changables[0].element.offsetWidth-2+this.SNAP_CLOSE+2)+"px";b.element.style.top=this.changables[0].element.style.top;b.element.style.zIndex=1},shiftOthBoxes:function(b){b.currOrder=0;var e=-1;var c=-1;var d;for(var f=1;f<this.changables.length;f++){d=this.changables[f].element.style;if(b.element.id!=this.changables[f].element.id){e=Math.abs(toNum(b.element.style.top)-toNum(d.top));c=Math.abs(toNum(b.element.style.left)-toNum(d.left));if(e<this.AS_CLOSE&&c<this.AS_CLOSE&&this.changables[f].isDisplayed){toTop=toNum(d.top)-this.MOVE_BY;if(toTop>0){d.top=(toNum(d.top)-this.MOVE_BY)+"px"}else{d.left=(toNum(d.left)+this.MOVE_BY)+"px"}this.shiftOthBoxes(this.changables[f]);break}}}},snapWindow:function(d,i,h,f,b){var c;var e;if(this.isSnappable==true){for(var g=0;g<this.changables.length;g++){if(this.changables[g].isDisplayed==true&&d.id!=this.changables[g].element.id){c=toNum(this.changables[g].element.style.left);e=toNum(this.changables[g].element.style.top);if(Math.abs(i-(c+this.changables[g].element.offsetWidth))<this.SNAP_DIST){d.style.left=(c+this.changables[g].element.offsetWidth+this.SNAP_CLOSE)+"px"}else{if(Math.abs((i+d.offsetWidth)-c)<this.SNAP_DIST){d.style.left=(c-f-this.SNAP_CLOSE)+"px"}else{if(Math.abs(h-(e+this.changables[g].element.offsetHeight))<this.SNAP_DIST){d.style.top=((e+this.changables[g].element.offsetHeight)+this.SNAP_CLOSE)+"px"}else{if(Math.abs((h+b)-e)<this.SNAP_DIST){d.style.top=(e-b-this.SNAP_CLOSE)+"px"}}}}}}}},displayAll:function(c){for(var b=1;b<this.changables.length;b++){if(this.changables[b].isDisplayed==c){this.displayObject(this.changables[b].element.id)}}},getIsSnappable:function(){return this.isSnappable},setIsSnappable:function(b){this.isSnappable=b}}},this);ChangableList.create(function HidableList(a){return{COLLAPSED:"Clps",text:null,extra:null,dispClass:null,innerHtmlE:null,innerHtmlC:null,setDisplay:function(f,c,d,e,b){this.text=f;this.dispClass=c;this.innerHtmlE=d;this.innerHtmlC=e;this.extra=b},closeDisplays:function(b){for(var c=0;c<this.changables.length;c++){this.changables[c].isDisplayed=true;if(c!=b){this.displayObject(this.changables[c].element.id)}}},displayObject:function(f){var c=this.getChangableFromId(f);if(c!=null){var d=$("#"+f+this.COLLAPSED)[0];var e=$("#"+f+this.text)[0];if(d==null){d=$("#"+f+this.extra)[0]}else{var b=$("#"+f+this.extra)[0]}if(c.isDisplayed==false){c.isDisplayed=true;if(this.dispClass!=null){c.element.className=this.dispClass}if(d!=null){d.innerHTML=this.innerHtmlC}if(e!=null){e.style.display="inline"}if(b!=null){b.style.display="inline"}}else{c.isDisplayed=false;if(this.dispClass!=null){c.element.className=this.dispClass+this.COLLAPSED}if(d!=null){d.innerHTML=this.innerHtmlE}if(e!=null){e.style.display="none"}if(b!=null){b.style.display="none"}}}}}},this);function toggleSmoothWindows(){if(movesPerDraw>0){movesPerDraw=0}else{movesPerDraw=8}}var ctrlDown=false;var maxZIndex=3;var movables;var itemsOut=false;var curObject=null;var mainMenu;var menuOpen=false;var MARGIN_LEFT=21;var homeWidth=700;var menuWidth=112;var attachMargin=12;$(document).keydown(function(){deRegisterMovables()});$(document).keyup(function(){registerMovables()});document.addEventListener("mouseup",function(){putInFront(curObject)},false);jQuery(document).ready(function(){var c=$().window_tiles({after:[function(){pages.init_home()},function(){pages.init_skills()},function(){pages.init_exp()},function(){pages.init_demos()},function(){pages.init_blog()}]});var e=(window.location.hostname);if(window.location.port!=""){e+=":"+window.location.port}var a={};var d=["/images/menu_icons/home_page_grey.png","/images/menu_icons/skills_page_grey.png","/images/menu_icons/experience_page_grey.png","/images/menu_icons/demos_page_grey.png","/images/menu_icons/blog_page_grey.png"];a["http://"+e+d[0]]=function(){c.trigger_open(0)};a["http://"+e+d[1]]=function(){c.trigger_open(1)};a["http://"+e+d[2]]=function(){c.trigger_open(2)};a["http://"+e+d[3]]=function(){c.trigger_open(3)};a["http://"+e+d[4]]=function(){c.trigger_open(4)};var b=$(document.body).icbm({map_imgs:a,z_index:3});b.set_open(0)});var pages=(function(){return{defaults:function(){$("img").each(function(){if($(this).attr("class")!="icbm_image"&&$(this)[0].id!="mainImg"){this.parentNode.addEventListener("mousedown",function(a){if(a.target.id=="hMainPicture"){demos_ns.resize_img(a.target.childNodes[1])}else{demos_ns.resize_img(a.target)}},true)}})},init_home:function(){this.defaults();$(".mainImage").each(function(b,a){$(a).attr("src",$("#mainImg").attr("src").replace("_s",""))})},init_skills:function(){this.defaults();skills_ns.init()},init_exp:function(){this.defaults();exp_ns.init()},init_demos:function(){this.defaults();demos_ns.init()},init_blog:function(){this.defaults();blog_ns.init()}}})();var skills_ns=(function skills_ns(){return{init:function(){var c=this;var d=utility.attach_show_events({triggers:$("div[id^=skills_collapse_skill]:visible"),event:"click",collapsers:$("div[id^=collapse_points_skill]:visible"),delay:false,on_show:function(e,f){$(f).show();$("#skills_collapse_button_"+e.id.split("_").pop())[0].innerHTML=utility.SHOW},on_hide:function(e,f){$(f).hide();$("#skills_collapse_button_"+e.id.split("_").pop())[0].innerHTML=utility.HIDE}}).close("all").open(0);var b=constant.page_text.skills.skill_types;for(var a=0;a<b.length;a++){utility.attach_show_events({triggers:$("button[id^=skills_point_collapse_skill_"+a+"]:visible"),event:"click",collapsers:$("div[id^=collapse_point_points_skill_"+a+"]:visible"),delay:false,parent:this,on_show:function(e,f){$(f).show();e.innerHTML=utility.SHOW},on_hide:function(e,f){$(f).hide();e.innerHTML=utility.HIDE}}).close("all")}}}})();exp_ns=(function(){var a;return{init:function(){var b=$(".job:visible");for(var c=0;c<b.length;c++){if(!$("#job"+c+"jobText")[0]){b.splice(c,1);c--}}utility.attach_show_events({triggers:b,event:"click",collapsers:$(".jobText:visible"),delay:false,on_show:function(d,e){$(e).show();$("#job"+d.id[d.id.length-1]+"Clps")[0].innerHTML=utility.SHOW},on_hide:function(d,e){$(e).hide();$("#job"+d.id[d.id.length-1]+"Clps")[0].innerHTML=utility.HIDE}}).close("all").open(0)}}})();demos_ns=(function(){var a=[];var d;var c;var e;var b=false;return{init:function(){utility.attach_show_events({triggers:$('div[id^="demo_"]:visible'),event:"click",collapsers:$('div[id^="demolinks_"]:visible'),delay:false,on_show:function(f,g){$(g).show();$("#demo"+f.id[f.id.length-1]+"Clps")[0].innerHTML=utility.SHOW},on_hide:function(f,g){$(g).hide();$("#demo"+f.id[f.id.length-1]+"Clps")[0].innerHTML=utility.HIDE}}).close("all").open(0)},resize_img:function(k,i){$("#newBg").remove();if(i==null&&b){return false}var g=false;var j;var h;d=document.createElement("img");c=document.createElement("div");e=document.createElement("button");d.src=k.src.replace("_s","");d.className="viewImage";d.style.position="fixed";this.scale_img(d);if(d.width==0){b=true;c.id="newBg";c.className="viewBg";c.style.position="fixed";c.innerHTML='<h1 style="color: white;text-align:center;font-size: 80px">Loading Image...</h1>';document.body.appendChild(c);c.onclick=this.remove_resize;var f=this;setTimeout(function(){f.resize_img(k,true)},100);return false}j=document.documentElement.clientWidth-d.width;h=document.documentElement.clientHeight-d.height;d.style.marginLeft=(j*0.5)+"px";d.style.marginTop=(h*0.45)+"px";e.className="closeBtnNew";e.innerHTML="X";e.style.marginLeft=((j*0.5)+d.width-29)+"px";e.style.marginTop=((h*0.45)+5)+"px";e.style.position="fixed";c.id="newBg";c.className="viewBg";c.style.position="fixed";document.body.appendChild(d);document.body.appendChild(c);document.body.appendChild(e);c.onclick=this.remove_resize;e.onclick=this.remove_resize;d.onclick=this.remove_resize;b=false;return false},scale_img:function(g){var f=this.fits_in_win(g);g.width=(g.width*f);g.height=(g.height*f)-20},fits_in_win:function(g){var h=1;var i=document.documentElement.clientHeight;var f=document.documentElement.clientWidth;if(i-d.height<0){h=(i/d.height)}if(f-d.width<0){if(h>f/d.width){h=f/d.width}}return h},remove_resize:function(){document.body.removeChild(d);document.body.removeChild(c);document.body.removeChild(e)},display_flash:function(f){if(f==null){window.location="video.html"}else{window.location=f}}}})();blog_ns=(function(){var b=new Array();var a;return{init:function(){var d=["blog1_1"];var c=["blog2_1"];b=new HidableList(d);b.setDisplay("Txt",null,"+","-");blog2=new HidableList(c);blog2.setDisplay("Txt",null,"+","-");a=$("#monthMenuBlog")[0];this.blog_events()},blog_events:function(){$("#quickChooseBtn").click($.proxy(function(){this.open_quick_c()},this))},toggle_blog:function(c){switch(c.charAt(4)){case"1":b.displayObject(c);break;default:alert("error no second blog page")}},display_month:function(c){var d=$("#bTitleWrapper")[0];var e=$("#bTextWrapper")[0];d.innerHTML="<h1>Jacob Friesen's Blog: "+c.replace("_"," ")+"</h1>";e.innerHTML=readFile("blog/"+c+".html");b.closeDisplays(0)},open_quick_c:function(){if(a.style.display=="none"){a.style.display="inline"}else{a.style.display="none"}}}})();function putInFront(a){if(a!=null){if(a.style.zIndex>998){subOrderings()}maxZIndex++;a.style.position="absolute";a.style.zIndex=maxZIndex;maxZIndex++;$("#rolloutMenu").css("zIndex",maxZIndex)}}function toNum(a){return Number(a.slice(0,a.length-2))};